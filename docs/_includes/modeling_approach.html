<!-- Services Section -->
    <section id="models">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <h2 class="section-heading">Baseline Model</h2>
                    <h3 class="section-subheading text-muted">Recommender System</h3>
                </div>

                <p>Our baseline model was a NearestNeighbors algorithm from sklearn that is trained on the entire dataset and utilizes the cosine similarity metric. As we are deploying the model on sparse input, we used the brute-force search algorithm to compute the nearest neighbors, per the documentation. </p>
                <pre class="prettyprint">
                #We utilize n_neighbors = 5 for default queries with this model
                model_knn = NearestNeighbors(metric = 'cosine', algorithm = 'brute')
                model_knn.fit(pivoted)
                </pre>
        <b>Input playlist (songs delineated by semicolons): Standing Next to Me - Live; Pony; You Were Right</b>

        <p>Generated songs:

        <i>['I Will Wait',
         'Lover Of The Light',
         'Set Fire to the Rain',
         'Hello',
         'Let Her Go',
         'Just Give Me a Reason',
         'Thinking Out Loud',
         'Riptide',
         'Stitches',
         ...</i>
         <p>

                <div class="col-lg-12 text-center">
                    <h2 class="section-heading">Improvements on the Baseline Model</h2>
                    <h3 class="section-subheading text-muted">Sentiment Analysis.</h3>
                </div>
                <blockquote>
                 <p><b>Incorporating musical sensibilities into song recommendations is crucial for personalizing automatic playlist generation.</b> The more impulsive and customized a song is the more chances there are that it could find itself in a playlist without the choice being necessarily too complex or individualized. The less salient the details of the song, the better it is to serve as a guide to others. And the more are the details there are, the more it feels like an accurate reference.</p>
                <footer>â€”by GPT-2, generated using <cite><a href="https://talktotransformer.com/">https://talktotransformer.com/</a> built by Adam King</cite></footer>
                </blockquote>
                <p>The above quote was generated by a transformer model called GPT-2, with the prompt that was provided in bold. TODO Elaborate. We would like to leverage such capabilities for song recommendation.</p>

                <b>Note: Our sentiment analysis model currently supports taking one song as input, due to time constraints (TODO).</b>

                <div class="col-lg-12 text-center">
                    <h3 class="section-subheading text-muted">K-means Clustering.</h3>
                </div>
                <p>We observed that when using the baseline model using a K-nearest neighbor model utilizing cosine similarity, we noticed that recommendations that were assigned a high cosine similarity were not necessarily similar in audio features in relation to the input playlist.

                <b>Note: Our recommender system model can support taking one and multiple songs as input.</b>

                For the purposes of this project, we chose to extensively focus on the danceability, energy, valence, and specchiness features, considering that users would choose to have variability in aspects such as tempo.

                For example, users whoose initial playlist consists of songs that are have high danceability and energy are more likely to want to listen to such songs - users are also more likely to be open to songs with varying values of the other features (e.g. songs can have varying tempo, but still all be energetic).

                Therefore, with this approach, we leverage the K-means clustering approach used for the EDA to only output songs that belong to the same cluster(s) as the initial tracks. Combining the K-means and K-nearest neighbors algorithms, we came up with the following approach:

                <ol>
                <li>User gives us (say, 3) songs from their playlist.</li>
                <li>The user needs to take a quiz to narrow the recommendations based on preferences. We figure out the cluster that the k-means algorithm assigned the user's songs to, and <b>adjust the default answers of the next few questions in the quiz to what we think the user's preferences are.</b> In the case that the inputted playliat has songs from multiple clusters, we choose whatever cluster the inputted tracks are assigned to most and move forward; if all the tracks belong to seperate clusters, we pick the first and move forward. TODO - confirming on this. </li>
                <li>The user can choose to keep the default answers, or choose their own answers (which we give priority to).</li>  
                <li>We use the KNN algorithm with cosine similarity to get the recommendations.</li>
                <li>Then, if the user chose the default values, we extract the recommendations that belong to the same cluster that the user's songs were in. Or, if the user chose their own answers, we figure out which cluster best matches that description and then only get songs that are from that cluster.</li>
                </ol>
                </p>

                <div class="col-lg-12 text-center">
                    <h3 class="section-subheading text-muted">Metrics - evaluating our models</h3>
                </div>
                <p>Because we are primarily interested in our ability to use our models to retrieve related tracks, we will look at R-precision of our models. Followinf the RecSys challenge (https://recsys- challenge.spotify.com/rules), R-precision is the number of retrieved relevant tracks divided by the number of known relevant tracks. With a perfect performance the R-precision of our model would approach 1.0 and we will evaluate our models accordingly.</p>
                    <div class="col-lg-12 text-center">
                    <img src="img/R-precision.JPG" alt="R-precision">
                </div>
            </div>

        </div>
    </section>
